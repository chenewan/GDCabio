<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.byd.emg.mapper.SectionAnalysisMapper" >

    <!--<select id="getsectionAnalysis_Start" resultType="com.byd.emg.pojo.SectionAnalysis" >
       SELECT top 1 * FROM Sankitu WHERE [Section]='${Section_name}' and [Date_time] &gt;='${Start_time}' order by Date_time asc

    </select>


    <select id="getsectionAnalysis_End" resultType="com.byd.emg.pojo.SectionAnalysis" >
       SELECT top 1 * FROM Sankitu WHERE [Section]='${Section_name}' and [Date_time] &lt;='${End_time}' order by Date_time desc

    </select>

    <select id="getsectionAnalysis_Start_2" resultType="com.byd.emg.pojo.SectionAnalysis" >
       SELECT top 1 * FROM Sankitu WHERE [Section]='${Section_name}' and [Date_time] &gt;='${Start_time}' order by Date_time asc

    </select>


    <select id="getsectionAnalysis_End_2" resultType="com.byd.emg.pojo.SectionAnalysis" >
       SELECT top 1  * FROM Sankitu WHERE [Section]='${Section_name}' and [Date_time] &lt;='${End_time}' order by Date_time desc

    </select>





    <select id="getsectionAnalysis_Histogram_Start" resultType="java.lang.String" >
       SELECT top 1 ${medium}  FROM Sankitu WHERE [Section]='${Section_name}' and [Date_time] &gt;='${Start_time}' order by Date_time asc

    </select>

    <select id="getsectionAnalysis_Histogram_End" resultType="java.lang.String" >
       SELECT top 1  ${medium}  FROM Sankitu WHERE [Section]='${Section_name}' and [Date_time] &lt;='${End_time}' order by Date_time desc

    </select>

    <select id="getsectionAnalysis_Histogram_Start_2" resultType="java.lang.String" >
       SELECT top 1  ${medium}  FROM Sankitu WHERE [Section]='${Section_name}' and [Date_time] &gt;='${Start_time}' order by Date_time asc

    </select>

    <select id="getsectionAnalysis_Histogram_End_2" resultType="java.lang.String" >
       SELECT top 1  ${medium}  FROM Sankitu WHERE [Section]='${Section_name}' and [Date_time] &lt;='${End_time}' order by Date_time desc

    </select>-->

    <select id="getK3Value" parameterType="java.lang.String" resultType="java.lang.Double">
        select  cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) realValue from realValue_power_table where realValue_tagname='${tagname}'
    </select>

    <!-- 1.1发酵 -->
    <select id="fajiao_power" resultType="java.lang.Double" >
	SELECT SUM(t3.result) FROM
(SELECT  t1.num1-t2.num2 as result FROM
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110907-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110907-01-EP' order by time desc) t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110907-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110907-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110907-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110907-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110907-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110907-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110907-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110907-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110907-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110907-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110905-08-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc) t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110905-08-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110905-08-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110905-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110905-01-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110905-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110905-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110905-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110905-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110905-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110905-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110905-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110905-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110905-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110905-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110905-06-EP' and his_date &lt;='${End_t}'order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110905-06-EP'order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110905-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110905-07-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110905-07-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110905-07-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110904-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110904-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110904-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110904-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110904-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110904-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110904-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110904-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110904-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110904-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110904-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110904-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110904-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110904-01-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110904-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110906-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110906-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110906-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110906-01-EP' and his_date &lt;='${End_t}'  order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110906-01-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110906-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-10903-00-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-10903-00-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-10903-00-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110904-06-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110904-06-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110904-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110904-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110904-01-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110904-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110914-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110914-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110914-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110914-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110914-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110914-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110914-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110914-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110914-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-01-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-06-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-06-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-07-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-07-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-07-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-08-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-08-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-08-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-09-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-09-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-09-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110910-10-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110910-10-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110910-10-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110910-15-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110910-15-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110910-15-EP' and his_date &gt;='${Start_t}'  order by his_date asc)t2
) t3
    </select>
    <!-- 1.2y预处理 -->
    <select id="yuchuli_power" resultType="java.lang.Double" >
        SELECT SUM(t3.result) result FROM
        (SELECT  t1.num1-t2.num2 as result FROM
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-01-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
       <!-- SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='连续出料' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='连续出料' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='连续出料' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL-->
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-06-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-06-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-07-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-07-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-07-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110902-08-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110902-08-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110902-08-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>
    <!-- 1.3浸出 -->
    <select id="jinchu_power" resultType="java.lang.Double" >
        SELECT t3.result-t4.result result FROM
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-00-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-00-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-00-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2)t3,
        (SELECT SUM(t3.result) result FROM
        (SELECT  t1.num1-t2.num2 as result FROM
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-01-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-02-EP' and his_date &lt;='${End_t}'  order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-06-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-06-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-07-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-07-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-07-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-08-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-08-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-08-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-09-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-09-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-09-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-10-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-10-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-10-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-11-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-11-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-11-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-12-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-12-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-12-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-13-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-13-EP'  order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-13-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        )t3
        )t4
    </select>
    <!-- 1.4精炼 -->
    <select id="jinglian_power" resultType="java.lang.Double" >
        select SUM(t3.result) result from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-01-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-05-EP' and his_date &lt;='${End_t}'  order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-06-EP' and his_date &lt;='${End_t}'  order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-06-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-07-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-07-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-07-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-08-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-08-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-08-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-09-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-09-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-09-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-10-EP' and his_date &lt;='${End_t}'  order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-10-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-10-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-11-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-11-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-11-EP' and his_date &gt;='${Start_t}'  order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-12-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-12-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-12-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110903-13-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110903-13-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110903-13-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110909-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110909-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110909-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>
    <!-- 1.5动力 -->
    <select id="dongli_power" resultType="java.lang.Double" >
SELECT SUM(t3.result) FROM
(
SELECT  t1.num1-t2.num2 as result FROM
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110909-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110909-01-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110909-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110910-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110910-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110910-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110910-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110910-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110910-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110910-10-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110910-10-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110910-10-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110909-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110909-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110909-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110909-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110909-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110909-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110910-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110910-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110910-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110909-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110909-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110909-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
) t3
    </select>
    <!-- 1.6锅炉 -->
    <select id="guolu_power" resultType="java.lang.Double" >
        select t3.result-t4.result result from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110910-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc) t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110910-05-EP' order by time desc) t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110910-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc) t2) t3,
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110910-06-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110910-06-EP' order by time desc )t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110910-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2) t4
    </select>
    <!-- 1.7污水 -->
    <select id="wushui_power" resultType="java.lang.Double" >
      SELECT  t1.num1-t2.num2 result  from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110910-08-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110910-08-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110910-08-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
    </select>
    <!-- 1.8QC -->
    <select id="qc_power" resultType="java.lang.Double" >
        SELECT SUM(t3.result) result FROM
        (SELECT  t1.num1-t2.num2 as result FROM
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110907-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110907-01-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110907-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110907-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110907-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110907-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110907-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110907-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110907-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>
    <!-- 1.9运行部 -->
    <select id="yunxing_power" resultType="java.lang.Double" >
        SELECT SUM(t3.result) result FROM
        (SELECT  t1.num1-t2.num2 as result FROM
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110907-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110907-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110907-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110905-08-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110905-08-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110905-08-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110905-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110905-01-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110905-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110905-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110905-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110905-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110905-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110905-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110905-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110905-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110905-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110905-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110905-06-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110905-06-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110905-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110905-07-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110905-07-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110905-07-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>
    <!-- 1.10行政 -->
    <select id="xingzheng_power" resultType="java.lang.Double" >
        SELECT SUM(t3.result) result FROM
        (SELECT  t1.num1-t2.num2 as result FROM
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110904-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110904-01-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110904-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110904-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110904-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110904-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110904-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110904-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110904-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110904-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110904-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110904-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>

    <!-- 发酵变压器 -->
    <select id="fjbyq" resultType="java.lang.Double" >
    SELECT SUM(t3.result) result FROM
    (SELECT  t1.num1-t2.num2 as result FROM
    <choose>
        <when test="End_t != '-1'">
            (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110910-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
        </when>
        <otherwise>
            (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110910-01-EP' order by time desc)t1,
        </otherwise>
    </choose>
    (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110910-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
    ) t3
</select>
    <!-- 动力联络柜 -->
    <select id="dlllg" resultType="java.lang.Double" >
        SELECT  t1.num1-t2.num2 as result FROM
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1  cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110909-06-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1  cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110909-06-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110909-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

    </select>
    <!-- 集装箱冷库 -->
    <select id="jzxlk" resultType="java.lang.Double" >
        SELECT SUM(t3.result) result FROM
        (SELECT  t1.num1-t2.num2 as result FROM
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110905-08-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110905-08-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110905-08-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>

    <!-- 冷冻水循环塔系统 -->
    <select id="ldsxhtxt" resultType="java.lang.Double" >
      SELECT SUM(t3.result) result FROM
(SELECT  t1.num1-t2.num2 as result FROM

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-01-EP' order by time desc)t1,
            </otherwise>
        </choose>

(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-06-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-06-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-07-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-07-EP' order by time desc)t1,
            </otherwise>
        </choose>


(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-07-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-08-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-08-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-08-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-09-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-09-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-09-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-10-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-10-EP' order by time desc)t1,
            </otherwise>
        </choose>


(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-10-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-11-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-11-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-11-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-12-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-12-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-12-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-13-EP' and his_date &lt;='${End_t}'  order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-13-EP' order by time desc)t1,
            </otherwise>
        </choose>


(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-13-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
) t3
    </select>

    <!-- 循环水泵塔系统 -->
    <select id="xhsbtxt" resultType="java.lang.Double" >
      SELECT SUM(t3.result) result FROM
(SELECT  t1.num1-t2.num2 as result FROM

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110916-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110916-01-EP' order by time desc)t1,
            </otherwise>
        </choose>

(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110916-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110916-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110916-02-EP' order by time desc)t1,
            </otherwise>
        </choose>


(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110916-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110916-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110916-03-EP' order by time desc)t1,
            </otherwise>
        </choose>


(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110916-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110916-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110916-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110916-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110916-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110916-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110916-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110916-06-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110916-06-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110916-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110916-07-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110916-07-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110916-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

) t3

    </select>

    <!-- 气源空压机 -->
    <select id="qykyj" resultType="java.lang.Double" >
       SELECT SUM(t3.result) result FROM
(SELECT  t1.num1-t2.num2 as result FROM

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110919-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110919-01-EP' order by time desc)t1,
            </otherwise>
        </choose>

(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110919-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110919-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110919-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110919-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110919-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110919-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110919-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110919-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110919-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110919-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110919-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110919-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110919-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
) t3
    </select>

    <!-- 空压机泵塔系统 -->
    <select id="kyjbtxt" resultType="java.lang.Double" >
     SELECT SUM(t3.result) result FROM
(SELECT  t1.num1-t2.num2 as result FROM

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110918-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110918-01-EP' order by time desc)t1,
            </otherwise>
        </choose>

(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110918-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110918-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110918-02-EP' order by time desc)t1,
            </otherwise>
        </choose>

(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110918-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110918-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110918-03-EP' order by time desc)t1,
            </otherwise>
        </choose>

(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110918-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110918-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110918-04-EP' order by time desc)t1,
            </otherwise>
        </choose>


(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110918-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110918-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110918-05-EP' order by time desc)t1,
            </otherwise>
        </choose>


(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110918-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from

        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110918-06-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110918-06-EP' order by time desc)t1,
            </otherwise>
        </choose>


(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110918-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

UNION ALL
SELECT  t1.num1-t2.num2 as result from


        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110918-07-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110918-07-EP' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110918-07-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
) t3

    </select>
<!-- 、、、、、、、、、、、、、、、、、、电，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，-->
    <select id="fajiao_tapwater" resultType="java.lang.Double" >
        select SUM(t3.result) from
(SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_tapWater WHERE tagname='FIT-092501-08-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_tapWater_table WHERE realValue_tagname='FIT-092501-08-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_tapWater WHERE tagname='FIT-092501-08-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
) t3
    </select>

    <select id="jinglian_tapwater" resultType="java.lang.Double" >
        select SUM(t3.result) from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT  top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_tapWater WHERE tagname='FIT-092501-06-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_tapWater_table WHERE realValue_tagname='FIT-092501-06-EQ' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_tapWater WHERE tagname='FIT-092501-06-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>

    <select id="dongli_tapwater" resultType="java.lang.Double" >
        select SUM(t3.result) from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_tapWater WHERE tagname='FIT-092501-02-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_tapWater_table WHERE realValue_tagname='FIT-092501-02-EQ' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_tapWater WHERE tagname='FIT-092501-02-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>

    <select id="guolu_tapwater" resultType="java.lang.Double" >
        select SUM(t3.result) from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_tapWater WHERE tagname='FIT-092501-03-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_tapWater_table WHERE realValue_tagname='FIT-092501-03-EQ' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_tapWater WHERE tagname='FIT-092501-03-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>

    <select id="wushui_tapwater" resultType="java.lang.Double" >
        select SUM(t3.result) from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_tapWater WHERE tagname='FIT-092501-05-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_tapWater_table WHERE realValue_tagname='FIT-092501-05-EQ' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_tapWater WHERE tagname='FIT-092501-05-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>

    <select id="xingzheng_tapwater" resultType="java.lang.Double" >

SELECT (t3.result-t5.result)rs FROM
(SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_tapWater WHERE tagname='FIT-092501-01-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_tapWater_table WHERE realValue_tagname='FIT-092501-01-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_tapWater WHERE tagname='FIT-092501-01-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
)t3,
(select SUM(t4.result) result from
(SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_tapWater WHERE tagname='FIT-092501-02-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_tapWater_table WHERE realValue_tagname='FIT-092501-02-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_tapWater WHERE tagname='FIT-092501-02-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_tapWater WHERE tagname='FIT-092501-03-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_tapWater_table WHERE realValue_tagname='FIT-092501-03-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_tapWater WHERE tagname='FIT-092501-03-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_tapWater WHERE tagname='FIT-092501-05-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_tapWater_table WHERE realValue_tagname='FIT-092501-05-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_tapWater WHERE tagname='FIT-092501-05-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_tapWater WHERE tagname='FIT-092501-06-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_tapWater_table WHERE realValue_tagname='FIT-092501-06-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_tapWater WHERE tagname='FIT-092501-06-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_tapWater WHERE tagname='FIT-092501-08-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_tapWater_table WHERE realValue_tagname='FIT-092501-08-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_tapWater WHERE tagname='FIT-092501-08-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
)t4)t5
    </select>

    <!-- 、、、、、、、、、、、、、、、、、、水，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，-->

    <select id="fajiao_circulatingWate_EP" resultType="java.lang.Double" >
        SELECT (t5.re-t4.result)rs FROM
        (select SUM(t3.result)re from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='FIT-092101-01-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='FIT-092101-01-EQ' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='FIT-092101-01-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='FIT-092101-02-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='FIT-092101-02-EQ' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='FIT-092101-02-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3)t5,

        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='Fit-092202-02-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='Fit-092202-02-EQ' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='Fit-092202-02-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        )t4
    </select>

    <select id="jinglian_circulatingWate_EP" resultType="java.lang.Double" >
  select SUM(t3.result) from
(SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='FIT-092202-02-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='FIT-092202-02-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='FIT-092202-02-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='FIT-092202-03-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='FIT-092202-03-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='FIT-092202-03-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

) t3
    </select>

    <select id="dongli_circulatingWate_EP" resultType="java.lang.Double" >
        select SUM(t3.result) from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='FIT-092101-01-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='FIT-092101-01-EQ' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='FIT-092101-01-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='FIT-092101-02-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='FIT-092101-02-EQ' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='FIT-092101-02-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

        ) t3
    </select>

    <!-- 、、、、、、、、、、、、、、、、、、循环水累积流量，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，-->
    <select id="fajiao_circulatingWate_TE" resultType="java.lang.Double" >
SELECT (t5.re-t4.result)rs FROM
(select SUM(t3.result)re from
(SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='FIT-092101-01-TE' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='FIT-092101-01-TE' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='FIT-092101-01-TE' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='FIT-092101-02-TE' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='FIT-092101-02-TE' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='FIT-092101-02-TE' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
) t3)t5,

(SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='Fit-092202-02-TE' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='Fit-092202-02-TE' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='Fit-092202-02-TE' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
)t4
    </select>

    <select id="jinglian_circulatingWate_TE" resultType="java.lang.Double" >
        select SUM(t3.result) from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='FIT-092202-02-TE' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='FIT-092202-02-TE' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='FIT-092202-02-TE' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='FIT-092202-03-TE' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='FIT-092202-03-TE' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='FIT-092202-03-TE' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

        ) t3
    </select>

    <select id="dongli_circulatingWate_TE" resultType="java.lang.Double" >
        select SUM(t3.result) from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='FIT-092101-01-TE' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='FIT-092101-01-TE' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='FIT-092101-01-TE' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='FIT-092101-02-TE' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='FIT-092101-02-TE' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='FIT-092101-02-TE' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>
    <select id="zongxunhuanshui_EP" resultType="java.lang.Double" >
        select SUM(t3.result) result from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='FIT-092101-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='FIT-092101-01-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='FIT-092101-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='FIT-092101-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='FIT-092101-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='FIT-092101-02-EP' and his_date &gt;='${Start_t}'  order by his_date asc)t2
        ) t3
    </select>

    <select id="zongxunhuanshui_TE" resultType="java.lang.Double" >
        select SUM(t3.result) result from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='FIT-092101-01-TE' and his_date &lt;='${End_t}'  order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='FIT-092101-01-TE' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='FIT-092101-01-TE' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_circulatingWate WHERE tagname='FIT-092101-02-TE' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_circulatingWater_table WHERE realValue_tagname='FIT-092101-02-TE' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_circulatingWate WHERE tagname='FIT-092101-02-TE' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>
    <!-- 、、、、、、、、、、、、、、、、、、循环水累积冷值，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，-->
    <select id="fajiao_freezeWater_EP" resultType="java.lang.Double" >
        SELECT (t3.result-t4.result)rs FROM
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_freezeWater WHERE tagname='Fit-092202-01-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_freezeWater_table WHERE realValue_tagname='Fit-092202-01-EQ' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_freezeWater WHERE tagname='Fit-092202-01-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        )t3,

        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_freezeWater WHERE tagname='FIT-092202-02-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_freezeWater_table WHERE realValue_tagname='FIT-092202-02-EQ' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_freezeWater WHERE tagname='FIT-092202-02-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        )t4
    </select>

    <select id="jianglian_freezeWater_EP" resultType="java.lang.Double" >
select SUM(t3.result) from
(SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_freezeWater WHERE tagname='Fit-092202-02-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_freezeWater_table WHERE realValue_tagname='Fit-092202-02-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_freezeWater WHERE tagname='Fit-092202-02-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

) t3
    </select>

    <select id="dongli_freezeWater_EP" resultType="java.lang.Double" >
        select SUM(t3.result) from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_freezeWater WHERE tagname='FIT-092202-01-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_freezeWater_table WHERE realValue_tagname='FIT-092202-01-EQ' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_freezeWater WHERE tagname='FIT-092202-01-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

        ) t3
    </select>


    <!-- 、、、、、、、、、、、、、、、、、、冷冻水累积流量，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，-->
    <select id="fajiao_freezeWater_TE" resultType="java.lang.Double" >

SELECT (t3.result-t4.result)rs FROM
(SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_freezeWater WHERE tagname='Fit-092202-01-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_freezeWater_table WHERE realValue_tagname='Fit-092202-01-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_freezeWater WHERE tagname='Fit-092202-01-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
)t3,
(SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_freezeWater WHERE tagname='FIT-092202-02-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_freezeWater_table WHERE realValue_tagname='FIT-092202-02-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_freezeWater WHERE tagname='FIT-092202-02-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
)t4
    </select>

    <select id="jianglian_freezeWater_TE" resultType="java.lang.Double" >
        select SUM(t3.result) from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_freezeWater WHERE tagname='Fit-092202-02-TE' and his_date &lt;='${End_t}'  order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_freezeWater_table WHERE realValue_tagname='Fit-092202-02-TE'  order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_freezeWater WHERE tagname='Fit-092202-02-TE' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

        ) t3
    </select>

    <select id="dongli_freezeWater_TE" resultType="java.lang.Double" >
        select SUM(t3.result) from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_freezeWater WHERE tagname='FIT-092202-01-TE' and his_date &lt;='${End_t}'  order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_freezeWater_table WHERE realValue_tagname='FIT-092202-01-TE'  order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_freezeWater WHERE tagname='FIT-092202-01-TE' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

        ) t3
    </select>

    <!-- 、、、、、、、、、、、、、、、、、、冷冻水累积冷值，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，-->

    <select id="fajiao_steamMeter" resultType="java.lang.Double" >
select SUM(t3.result) from
(SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_steamMeter WHERE tagname='Fit-012001-02-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_steamMeter_table WHERE realValue_tagname='Fit-012001-02-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_steamMeter WHERE tagname='Fit-012001-02-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_steamMeter WHERE tagname='Fit-012001-07-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_steamMeter_table WHERE realValue_tagname='Fit-012001-07-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_steamMeter WHERE tagname='Fit-012001-07-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_steamMeter WHERE tagname='Fit-012001-09-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_steamMeter_table WHERE realValue_tagname='Fit-012001-09-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_steamMeter WHERE tagname='Fit-012001-09-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
) t3
    </select>

    <select id="jinglian_steamMeter" resultType="java.lang.Double" >
        select SUM(t3.result) from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_steamMeter WHERE tagname='Fit-031001-01-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_steamMeter_table WHERE realValue_tagname='Fit-031001-01-EQ' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_steamMeter WHERE tagname='Fit-031001-01-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>

    <select id="guolu_steamMeter" resultType="java.lang.Double" >
        select SUM(t3.result) from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_steamMeter WHERE tagname='Fit-100601-04-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_steamMeter_table WHERE realValue_tagname='Fit-100601-04-EQ' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_steamMeter WHERE tagname='Fit-100601-04-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>

    <select id="wushui_steamMeter" resultType="java.lang.Double" >
        select SUM(t3.result) from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_steamMeter WHERE tagname='Fit-092501-09-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_steamMeter_table WHERE realValue_tagname='Fit-092501-09-EQ' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_steamMeter WHERE tagname='Fit-092501-09-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>

    <select id="xingzheng_steamMeter" resultType="java.lang.Double" >

SELECT (t5.re-t4.result)rs FROM
(select SUM(t3.result)re from
(SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_steamMeter WHERE tagname='Fit-100601-02-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_steamMeter_table WHERE realValue_tagname='Fit-100601-02-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_steamMeter WHERE tagname='Fit-100601-02-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_steamMeter WHERE tagname='Fit-100601-03-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_steamMeter_table WHERE realValue_tagname='Fit-100601-03-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_steamMeter WHERE tagname='Fit-100601-03-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
) t3)t5,

(SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_steamMeter WHERE tagname='Fit-100601-04-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_steamMeter_table WHERE realValue_tagname='Fit-100601-04-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_steamMeter WHERE tagname='Fit-100601-04-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_steamMeter WHERE tagname='Fit-012001-10-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_steamMeter_table WHERE realValue_tagname='Fit-012001-10-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_steamMeter WHERE tagname='Fit-012001-10-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_steamMeter WHERE tagname='Fit-092501-09-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_steamMeter_table WHERE realValue_tagname='Fit-092501-09-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_steamMeter WHERE tagname='Fit-092501-09-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_steamMeter WHERE tagname='Fit-031001-01-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_steamMeter_table WHERE realValue_tagname='Fit-031001-01-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_steamMeter WHERE tagname='Fit-031001-01-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
)t4
    </select>

    <select id="zong_steamMeter" resultType="java.lang.Double" >
        select SUM(t3.result) from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_steamMeter WHERE tagname='Fit-100601-05-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_steamMeter_table WHERE realValue_tagname='Fit-100601-05-EQ' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_steamMeter WHERE tagname='Fit-100601-05-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>
    <!-- 、、、、、、、、、、、、、、、、、、蒸汽，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，-->


    <select id="fajiao_fermentationAir" resultType="java.lang.Double" >
select SUM(t3.result) from
(SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_fermentationAir WHERE tagname='Fit-012801-02-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_fermentationAir_table WHERE realValue_tagname='Fit-012801-02-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_fermentationAir WHERE tagname='Fit-012801-02-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_fermentationAir WHERE tagname='Fit-012801-03-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_fermentationAir_table WHERE realValue_tagname='Fit-012801-03-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_fermentationAir WHERE tagname='Fit-012801-03-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_fermentationAir WHERE tagname='Fit-012801-04-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_fermentationAir_table WHERE realValue_tagname='Fit-012801-04-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_fermentationAir WHERE tagname='Fit-012801-04-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_fermentationAir WHERE tagname='Fit-012801-05-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_fermentationAir_table WHERE realValue_tagname='Fit-012801-05-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_fermentationAir WHERE tagname='Fit-012801-05-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_fermentationAir WHERE tagname='Fit-012801-06-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_fermentationAir_table WHERE realValue_tagname='Fit-012801-06-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_fermentationAir WHERE tagname='Fit-012801-06-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
UNION ALL
SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_fermentationAir WHERE tagname='Fit-012801-07-EQ' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_fermentationAir_table WHERE realValue_tagname='Fit-012801-07-EQ' order by time desc)t1,
            </otherwise>
        </choose>
(SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_fermentationAir WHERE tagname='Fit-012801-07-EQ' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
) t3
    </select>

    <!-- 、、、、、、、、、、、、、、、、、、发酵空气，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，，-->

    <!-- 2.1循环水电量 -->
    <select id="xunhuan_power" resultType="java.lang.Double" >
        select SUM(t3.result) result from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110916-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110916-01-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110916-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110916-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110916-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110916-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110916-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110916-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110916-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110916-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110916-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110916-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110916-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110916-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110916-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110916-06-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110916-06-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110916-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110916-07-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110916-07-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110916-07-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>
    <!-- 2.2冷冻水电量 -->
    <select id="lengdong_power" resultType="java.lang.Double" >
        select SUM(t3.result) result from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-01-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-06-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-06-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-07-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-07-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-07-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-08-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-08-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-08-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110917-09-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110917-09-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110917-09-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110904-10-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110904-10-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110904-10-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110904-11-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110904-11-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110904-11-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110904-12-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110904-12-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110904-12-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110904-13-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110904-13-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110904-13-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110910-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110910-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110910-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110910-11-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110910-11-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110910-11-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2

        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110909-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110909-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110909-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3

    </select>
    <!-- 2.3压缩空气电量  发酵-->
    <select id="yasuo_power" resultType="java.lang.Double" >
        select SUM(t3.result) result from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110910-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110910-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110910-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110910-11-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110910-11-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110910-11-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110909-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110909-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110909-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110908-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110908-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110908-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110908-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110908-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110908-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110908-06-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110908-06-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110908-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        <!--SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110918-06-EP' and his_date &lt;='${End_t}'  order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110918-06-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110918-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL-->
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110918-02-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110918-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110918-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110918-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110918-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110918-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110918-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110918-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110918-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110918-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110918-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110918-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110918-06-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110918-06-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110918-06-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110918-07-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110918-07-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110918-07-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>
    <!-- 2.4仪表空气用电量 -->
    <select id="yibiao_power" resultType="java.lang.Double" >
        select SUM(t3.result) result from
        (SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110919-01-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110919-01-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110919-01-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110919-02-EP' and his_date &lt;='${End_t}'  order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110919-02-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110919-02-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110919-03-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110919-03-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110919-03-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110919-04-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110919-04-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num2 FROM day_power WHERE tagname='JT-110919-04-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        UNION ALL
        SELECT  t1.num1-t2.num2 as result from
        <choose>
            <when test="End_t != '-1'">
                (SELECT top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float) num1 FROM day_power WHERE tagname='JT-110919-05-EP' and his_date &lt;='${End_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date desc)t1,
            </when>
            <otherwise>
                (SELECT top 1 cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 FROM realValue_power_table WHERE realValue_tagname='JT-110919-05-EP' order by time desc)t1,
            </otherwise>
        </choose>
        (SELECT top 1  cast(time_value as float) num2 FROM day_power WHERE tagname='JT-110919-05-EP' and his_date &gt;='${Start_t}' and convert(decimal(38,2),cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float))!=0.00 order by his_date asc)t2
        ) t3
    </select>



    <select id="serialn_numberEnd" resultType="java.lang.Integer" >
        SELECT top 1 id FROM Sankitu ORDER BY id DESC
    </select>

    <insert id="insert_sectionpower">
        <foreach collection="list" item="item" index= "index">
            insert into Sankitu (Section,Active_electric_energy,Cumulative_flow_of_tap_water,Cumulative_flow_of_circulating_water,Cumulative_Cooling_Value_of_Circulating_Water,
            Cumulative_flow_of_frozen_water,Cumulative_cold_value_of_frozen_water,Cumulative_steam_flow,Cumulative_air_flow,Date_time,Serialn_number)
            values ('${item.Section}', '${item.Active_electric_energy}', '${item.Cumulative_flow_of_tap_water}', '${item.Cumulative_flow_of_circulating_water}', '${item.Cumulative_Cooling_Value_of_Circulating_Water}', '${item.Cumulative_flow_of_frozen_water}', '${item.Cumulative_cold_value_of_frozen_water}', '${item.Cumulative_steam_flow}', '${item.Cumulative_air_flow}', '${item.Date_time}', '${item.Serialn_number}');
        </foreach>
    </insert>

    <select id="ReportForm_energy_consumption" resultType="com.byd.emg.pojo.SectionAnalysis" >
        SELECT
        SUM (
        CAST (
        Active_electric_energy AS float
        )
        ) AS Active_electric_energy,
        SUM (
        CAST (
        Cumulative_flow_of_tap_water AS float
        )
        ) AS Cumulative_flow_of_tap_water,
        SUM (
        CAST (Cumulative_steam_flow AS float)
        ) AS Cumulative_steam_flow
        FROM
        Sankitu
        WHERE
        Date_time &gt;= '${Start_t}'
        AND Date_time &lt;= '${End_t}'
        GROUP BY
        [Section]
        ORDER BY
        SUM (Serialn_number)

    </select>

    <select id="selectDate_time" parameterType="java.lang.String" resultType="java.lang.String">
        select ${method} from day_power where his_date!='' or his_date!=null;
    </select>

    <select id="getTestDateList" resultType="java.lang.String">
        select his_date from day_power where his_date!='' and his_date is not null and his_date &gt;='2019-07-12'
    </select>

    <select id="selectSankeyRangeDate" parameterType="java.lang.String" resultType="java.lang.String">
        select ${method} from day_power where his_date!='' and his_date is not null
    </select>

    <select id="getConsumptionValue" resultType="TimeJob">
      select case a.time_value when '' then '0.0' when null then '0.0' else time_value end as time_value,a.tagname as tagname,a.his_date as his_date from
      (<foreach collection="tagnameList" index="index" item="item" separator="union all">
        select t1.num1-t2.num2 as time_value,t2.tagname tagname,t2.his_date from
        <choose>
                <when test="realMark != '-1'">
                    (select top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as
                    float) num1 from ${hisTablename} where tagname='${item}' and his_date &gt;='${startDate}' and his_date &lt;='${endDate}'
                    and convert(decimal(38,2),cast(case time_value when '' then '0' when null then '0' else time_value end as float))>0 order by his_date desc)t1,
                </when>
                <otherwise>
                    (select top 1  cast(case realValue when '' then '0.0' when null then '0.0' else realValue end as float) num1 from ${realTablename} where realValue_tagname='${item}' order by time desc)t1,
                </otherwise>
            </choose>
        (select top 1 cast(case time_value when '' then '0.0' when null then '0.0' else time_value end as float)
        num2,tagname,his_date from ${hisTablename} where tagname='${item}' and his_date &gt;='${startDate}' and his_date &lt;='${endDate}'
        and convert(decimal(38,2),cast(case time_value when '' then '0' when null then '0' else time_value end as float))>0 order by his_date asc)t2
    </foreach>) a

    </select>







</mapper>

